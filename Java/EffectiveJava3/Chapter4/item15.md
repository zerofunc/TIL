# 아이템 15 클래스와 멤버의 접근 권한을 최소화하라
### 정보 은닉의 장점
- 시스템 개발 속도를 높임
    - 여러 컴포넌트를 병렬로 개발 가능
- 시스템 관리 비용을 낮춤
    - 각 컴포넌트를 더 빨리 파악하여 디버깅 가능
    - 다른 컴포넌트로 교체하는 부담 적음
- 정보 은닉 자체가 성능을 높여주지는 않지만, 성능 최적화에 도움을 줌
    - 완성된 시스템을 프로파일링해 최적화할 컴포넌트를 정한 다음 다른 컴포넌트에 영향을 주지
    않고 해당 컴포넌트만 최적화할 수 있기 때문
- 소프트웨어 재사용성을 높임
    - 외부에 거의 의존하지 않고 독자적으로 동작할 수 있는 컴포넌트라면 그 컴포넌트와
    함께 개발되지 않은 낯선 환경에서도 유용하게 쓰일 가능성이 큼
- 큰 시스템을 제작하는 난이도를 낮춤
    - 시스템 전체가 아직 미완성인 상태에서도 개별 컴포넌트의 동작 검증 가능
### 정보 은닉을 위한 장치
    - 접근 제어 메커니즘은 클래스, 인터페이스, 멤버의 접근성(접근 허용 범위)을 명시.
    - 각 요소의 접근성은 그 요소가 선언된 위치와 접근 제한자로 정해짐. 접근 제한자를 제대로 활용하는 것이 정보 은닉의 *핵심*
 
### 기본 원칙
- 모든 클래스와 멤버의 접근성을 가능한 한 좁혀야 함
    - 소프트웨어가 올바로 동작하는 한 항상 가장 낮은 접근 수준을 부여한다는 뜻

### 멤버에 부여할 수 있는 접근 수준 네 가지
1. private
    - 멤버를 선언한 톱레벨 클래스에서만 접근 가능
2. package-private
    - 멤버가 소속된 패키지 안의 모든 클래스에서 접근 가능
    - 접근 제한자를 명시하지 않았을 때 적용되는 패키지 접근 수준 ( 인터페이스의 멤버는 기본적으로 public )
3. protected
    - package-private의 접근 범위를 포함.
    - 이 멤버를 선언한 클래스의 하위 클래스에서도 접근 가능
4. public 
    - 모든 곳에서 접근 가능
    
### public 클래스의 인스턴스 필드는 되도록 public이 아니어야 함
- 필드가 가변 객체를 참조하거나, final이 아닌 인스턴스 필드를 public으로 선언하면
그 필드와 관련된 모든 것은 불변식을 보장할 수 없음.
- public 가변 필드를 갖는 클래스는 일반적으로 thread-safe 하지 않음.
    - 필드가 수정될 때 (락 획득 같은) 다른 작업을 할 수 없음
- 필드가 final이면서 불변 객체를 참조하는 경우
    - 내부 구현을 바꾸고 싶어도 그 public 필드를 없애는 방식으로 리팩터링 불가
- 정적 필드에서 예외
    - 해당 클래스가 표현하는 추상 개념을 완성하는 데 꼭 필요한 구성요소로써의 상수인 경우 public static final로 공개해도 좋음
        - 반드시 기본 타입 값이나 불변 객체를 참조해야함
        - 가변 객체를 참조할 경우 final이 아닌 필드에 적용되는 불이익이 그대로 적용됨
         
### 클래스에서 public static final 배열 필드를 두거나 이 필드를 반환하는 접근자 메서드를 제공해서는 안됨
- 길이가 0이 아닌 배열은 모두 변경 가능
    ```java
    // 보안 허점이 존재
    public static final Thing[] VALUES = {...};
    ```
- 접근자를 제공하면 클라이언트에서 그 배열의 내용을 수정할 수 있음.
- 해결 방법
    - 배열을 private으로 만들고 public 불변 리스트를 추가
    ```java
    private static final Thing[] PRIVATE_VALUES = {...};
    public static final List<Thing> VALUES = Collections.unmodifiableList(Arrays.asList(PRIVATE_VALUES));
    ```
    - 배열을 private으로 만들고 복사본을 반환하는 public 메서드 추가 (방어적 복사)
    ```java
    private static final Thing[] PRIVATE_VALUES = {...};
    public static final Thing[] values() {
      return PRIVATE_VALUES.clone();  
    }
    ```
## 정리
```
- 프로그램 요소의 접근성은 가능한 한 최소한으로
- 꼭 필요한 것만 골라 최소한의 public API를 설계
- 그 외에는 클래스, 인터페이스, 멤버가 의도치 않게 API로 공개되는 일이 없도록 함
- public 클래스는 상수용 public static final 필드 외에는 어떠한 public 필드도 가져서는 안됨
= public static final 필드가 참조하는 객체가 불변인지 확인
```    